# yaml-language-server: $schema=../poll-config.schema.json
#
# GitHub PR Reviews Poll Configuration
#
# Polls for PRs where your review is requested and creates devcontainer
# sessions with OpenCode to review them.
#
# Prerequisites:
# - MCP server 'github' configured in ~/.config/opencode/opencode.json
#
# Example MCP configurations:
#
# Option A - Remote (GitHub Copilot MCP):
#   {
#     "mcp": {
#       "github": {
#         "type": "remote",
#         "url": "https://api.githubcopilot.com/mcp/",
#         "enabled": true
#       }
#     }
#   }
#
# Option B - Local (using gh CLI token):
#   {
#     "mcp": {
#       "github": {
#         "type": "local",
#         "command": ["sh", "-c", "GITHUB_PERSONAL_ACCESS_TOKEN=$(gh auth token) npx -y @modelcontextprotocol/server-github"],
#         "enabled": true
#       }
#     }
#   }
#
# Fetch options (defaults shown):
#   fetch:
#     review_requested: "@me"  # PRs requesting your review
#     author: null             # Filter by PR author (e.g., "@me" for your PRs)
#     review_decision: null    # Filter by review status: CHANGES_REQUESTED, APPROVED, REVIEW_REQUIRED
#     state: "open"            # open, closed, or all
#     repo: null               # Single repo (owner/repo)
#     repos: null              # Multiple repos (array of owner/repo)
#     org: null                # Filter by organization

id: github-pr-reviews
source_type: github_pr

# Map GitHub repos/orgs to local repositories
# Most specific rule wins (repo+labels > labels > repo > org)
repo_filters:
  - repo: "owner/backend"
    repo_path: "~/code/backend"
  - repo: "owner/frontend"
    repo_path: "~/code/frontend"

# Optional: Configure automatic cleanup when PRs are merged/closed
# Defaults shown below - uncomment to customize
# cleanup:
#   on: [merged, closed]  # Terminal states that trigger cleanup
#   delay: 5m             # Grace period before cleanup (default: 5m)
#   actions:              # Actions to perform (in order)
#     - kill_session      # Kill the tmux session
#     - stop_container    # Stop the devcontainer
#     # - remove_clone    # Uncomment to also remove clone directory
